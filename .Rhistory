colSums(is.na(weatherAU))/nrow(weatherAU)
summary(weatherAU)
colSums(is.na(weatherAU))
colSums(is.na(weatherAU))/nrow(weatherAU)
str(weatherAU)
cat("")
colSums(is.na(weatherAU))
cat("")
colSums(is.na(weatherAU))/nrow(weatherAU)
colSums(is.na(weatherAU))
cat(" ")
colSums(is.na(weatherAU))/nrow(weatherAU)
colSums(is.na(weatherAU))
cat("\n")
colSums(is.na(weatherAU))/nrow(weatherAU)
weatherAU$Date <- as.Date(weatherAU$Date)
head(weatherAU)
print(i)
for (i in col(weatherAU)) {
print(i)
}
col(weatherAU)
for (i in colnames(weatherAU)) {
print(i)
}
for (i in 1:length(weatherAU)) {
print(i)
# print()
}
for (i in 1:length(weatherAU)) {
print(i)
print(colnames(weatherAU)[i])
# print()
}
for (i in 1:length(weatherAU)) {
for (i in 1:length(weatherAU)) {
paste0("Unique values in ", colnames(weatherAU)[i], ": ", unique(weatherAU[,i]))
}
for (i in 1:length(weatherAU)) {
paste0("Unique values in ", colnames(weatherAU)[i], ": ", unique(weatherAU[,i]))
}
q
for (i in 1:length(weatherAU)) {
paste0("Unique values in ", colnames(weatherAU)[i], ": ", unique(weatherAU[,i]))
}
for (i in 1:length(weatherAU)) {
paste0("Unique values in ", colnames(weatherAU)[i], ": ", unique(weatherAU[,i]))
}
for (i in 1:length(weatherAU)) {
print(paste0("Unique values in ", colnames(weatherAU)[i], ": ", unique(weatherAU[,i])))
}
unique(weatherAU[,1])
unique(weatherAU[,2])
for (i in 2:length(weatherAU)) {
print(paste0("Unique values in ", colnames(weatherAU)[i], ":"))
unique(weatherAU[,i]))
for (i in 2:length(weatherAU)) {
print(paste0("Unique values in ", colnames(weatherAU)[i], ":"))
unique(weatherAU[,i])
}
for (i in 2:length(weatherAU)) {
print(paste0("Unique values in ", colnames(weatherAU)[i], ":"))
print(unique(weatherAU[,i]))
}
for (cate in 1:length(weatherAU)) {
category <- ifelse(class(weatherAU[,cate]) == "factor", colnames(weatherAU)[cate], NULL)
}
categorical <- vector()
for (i in 1:length(weatherAU)) {
if (class(weatherAU[,i]) == "factor") {
category <- colnames(weatherAU)[i]
categorical <- c(categorical, category)
}
}
categorical
# print unique values in each categorical variable
for (i in 2:length(categorical)) {
print(paste0("Unique values in ", colnames(weatherAU$categorical[i]), ":"))
print(unique(weatherAU$categorical[i]))
}
colnames(weatherAU$categorical[1])
categorical[1]
# print unique values in each categorical variable
for (i in 2:length(categorical)) {
print(paste0("Unique values in ", colnames(weatherAU[,categorical[i]]), ":"))
print(unique(weatherAU[,categorical[i]]))
}
colnames(weatherAU[,categorical[1]])
categorical[1]
colnames(weatherAU[,"Location"])
colnames(weatherAU[,Location])
colnames(weatherAU$Location)
# print unique values in each categorical variable
for (i in 2:length(categorical)) {
print(paste0("Unique values in ", categorical[i], ":"))
print(unique(weatherAU[,categorical[i]]))
}
# print unique values in each categorical variable
for (i in 2:length(categorical)) {
print(paste0("Unique values in ", categorical[i], ":"))
print(unique(weatherAU[,categorical[i]]))
print(cat("\n"))
}
# print unique values in each categorical variable
for (i in 2:length(categorical)) {
print(paste0("Unique values in ", categorical[i], ":"))
print(levels(weatherAU[,categorical[i]]))
print(cat("\n"))
}
# print unique values in each categorical variable
for (i in 1:length(categorical)) {
print(paste0("Unique values in ", categorical[i], ":"))
print(levels(weatherAU[,categorical[i]]))
print(cat("\n"))
}
# print unique values in each categorical variable
for (i in 1:length(categorical)) {
print(paste0("Unique values in ", categorical[i], ":"))
print(levels(weatherAU[,categorical[i]]))
# print(cat("\n"))
}
categorical <- vector()
for (i in 1:length(weatherAU)) {
if (class(weatherAU[,i]) == "factor") {
category <- colnames(weatherAU)[i]
categorical <- c(categorical, category)
}
}
# print unique values in each categorical variable
for (i in 1:length(categorical)) {
print(paste0("Unique values in ", categorical[i], ":"))
print(levels(weatherAU[,categorical[i]]))
# print(cat("\n"))
}
table(weatherAU$Location)
table(weatherAU$Location, order())
sort(table(weatherAU$Location), decreasing = T)
categorical <- vector()
for (i in 1:length(weatherAU)) {
if (class(weatherAU[,i]) == "factor") {
category <- colnames(weatherAU)[i]
categorical <- c(categorical, category)
}
}
# print unique values in each categorical variable
for (i in 1:length(categorical)) {
print(paste0("Unique values in ", categorical[i], ":"))
print(levels(weatherAU[,categorical[i]]))
# print(cat("\n"))
}
categorical <- vector()
weatherAU[,categorical]
print(weatherAU[,categorical])
categorical <- vector()
categorical <- vector()
for (i in 1:length(weatherAU)) {
if (class(weatherAU[,i]) == "factor") {
category <- colnames(weatherAU)[i]
categorical <- c(categorical, category)
}
}
weatherAU[,categorical]
for (i in 1:length(weatherAU)-1) {
if (class(weatherAU[,i]) == "factor") {
category <- colnames(weatherAU)[i]
categorical <- c(categorical, category)
}
}
weatherAU[,categorical]
for (i in 1:(length(weatherAU)-1)) {
if (class(weatherAU[,i]) == "factor") {
category <- colnames(weatherAU)[i]
categorical <- c(categorical, category)
}
}
categorical <- vector()
for (i in 1:(length(weatherAU)-1)) {
if (class(weatherAU[,i]) == "factor") {
category <- colnames(weatherAU)[i]
categorical <- c(categorical, category)
}
}
weatherAU[,categorical]
DF <- weatherAU[,-categorical]
DF <- weatherAU[,-(categorical)]
library(tidyverse)
DF <- weatherAU %>%
select(-(categorical))
DF
DF <- weatherAU %>%
select(-(categorical))
DF
col(DF)
ncol(DF)
head(DF)
ncol(DF)
head(DF)
colSums(is.na(weatherAU))
cat("\n")
colSums(is.na(weatherAU))/nrow(weatherAU)
colSums(is.na(DF))
cat("\n")
colSums(is.na(DF))/nrow(DF)
summary(DF)
quantile(DF$Rainfall)
quantile(DF$Rainfall, na.rm = T)
min(DF$Rainfall)
min(DF$Rainfall, na.rm = T)
mean(DF$Rainfall, na.rm = T)
colnames(DF)
DF <- weatherAU %>%
select(-(categorical)) %>%
select(-RISK_MM)
head(DF)
colnames(DF)
colnames(DF)[2:18]
DF %>% pivot_longer(cols = colnames(DF)[2:18], names_to = "Type", values_to = "Value") %>%
ggplot(aes(x = Type,
y = Value)) +
coord_flip() +
geom_boxplot(aes(fill = Type))
DF %>% pivot_longer(cols = colnames(DF)[2:17], names_to = "Type", values_to = "Value") %>%
ggplot(aes(x = Type,
y = Value)) +
coord_flip() +
geom_boxplot(aes(fill = Type))
DF %>% select(colnames(DF)[2:17])
DF %>% select(colnames(DF)[2:17]) %>%
pivot_longer(cols = colnames(DF)[1:16], names_to = "Type", values_to = "Value")
DF
DF %>% select(colnames(DF)[2:17])
DF %>% select(colnames(DF)[2:17]) %>%
pivot_longer(cols = colnames(DF)[1:16], names_to = "Type", values_to = "Value")
DF %>% select(colnames(.)[2:17]) %>%
pivot_longer(cols = colnames(.)[1:16], names_to = "Type", values_to = "Value")
DF %>% select(colnames(.)[2:17]) %>%
pivot_longer(cols = colnames(.)[1:16], names_to = "Type", values_to = "Value") %>%
mutate(Value = as.numeric(Value))
DF %>% select(colnames(.)[2:17]) %>%
pivot_longer(cols = colnames(.)[1:16], names_to = "Type", values_to = "Value") %>%
mutate(Value = as.numeric(Value)) %>%
ggplot(aes(x = Type,
y = Value)) +
coord_flip() +
geom_boxplot(aes(fill = Type), show.legend = F)
DF %>% select(colnames(.)[2:17]) %>%
pivot_longer(cols = colnames(.)[1:16], names_to = "Type", values_to = "Value") %>%
mutate(Value = as.numeric(Value)) %>%
ggplot(aes(x = Type,
y = Value)) +
coord_flip() +
geom_boxplot(aes(fill = Type), show.legend = F) %>%
facet_null(~Type)
DF %>% select(colnames(.)[2:17]) %>%
pivot_longer(cols = colnames(.)[1:16], names_to = "Type", values_to = "Value") %>%
mutate(Value = as.numeric(Value)) %>%
ggplot(aes(x = Type,
y = Value)) +
coord_flip() +
geom_boxplot(aes(fill = Type), show.legend = F) %>%
facet_null(Type)
DF %>% select(colnames(.)[2:17]) %>%
pivot_longer(cols = colnames(.)[1:16], names_to = "Type", values_to = "Value") %>%
mutate(Value = as.numeric(Value)) %>%
ggplot(aes(x = Type,
y = Value)) +
coord_flip() +
geom_boxplot(aes(fill = Type), show.legend = F) %>%
facet_wrap(~Type)
DF %>% select(colnames(.)[2:17]) %>%
pivot_longer(cols = colnames(.)[1:16], names_to = "Type", values_to = "Value") %>%
mutate(Value = as.numeric(Value)) %>%
ggplot(aes(x = Type,
y = Value)) +
coord_flip() +
geom_boxplot(aes(fill = Type), show.legend = F) %>%
facet_wrap(~as.factor(Type))
DF %>% select(colnames(.)[2:17]) %>%
pivot_longer(cols = colnames(.)[1:16], names_to = "Type", values_to = "Value") %>%
mutate(Value = as.numeric(Value),
Type = as.factor(Type)) %>%
ggplot(aes(x = Type,
y = Value)) +
coord_flip() +
geom_boxplot(aes(fill = Type), show.legend = F) %>%
facet_wrap(~Type)
DF %>% select(colnames(.)[2:17]) %>%
pivot_longer(cols = colnames(.)[1:16], names_to = "Type", values_to = "Value") %>%
mutate(Type = as.factor(Type)) %>%
ggplot(aes(x = Type,
y = Value)) +
coord_flip() +
geom_boxplot(aes(fill = Type), show.legend = F) %>%
facet_wrap(~Type)
DF %>% select(colnames(.)[2:17]) %>%
pivot_longer(cols = colnames(.)[1:16], names_to = "Type", values_to = "Value") %>%
mutate(Type = as.factor(Type))
DF %>% select(colnames(.)[2:17]) %>%
pivot_longer(cols = colnames(.)[1:16], names_to = "Type", values_to = "Value") %>%
mutate(Type = as.factor(Type)) %>%
ggplot(aes(x = Type,
y = Value)) +
coord_flip() +
geom_boxplot(aes(fill = Type), show.legend = F) +
facet_wrap(~Type)
DF %>% select(colnames(.)[2:17]) %>%
pivot_longer(cols = colnames(.)[1:16], names_to = "Type", values_to = "Value") %>%
mutate(Type = as.factor(Type)) %>%
ggplot(aes(x = Type,
y = Value)) +
coord_flip() +
geom_boxplot(aes(fill = Type), show.legend = F)
is.na(DF)
colSums(is.na(DF))
sum(is.na(DF))
DF1 <- DF
replace_na(data = DF1$MinTemp, replace = mean)
replace_na(data = DF1$MinTemp, replace = median(DF1$MinTemp))
replace_na(data = DF1$MinTemp, replace = median(DF1$MinTemp)) %>% is.na()
replace_na(data = DF1$MinTemp, replace = median(DF1$MinTemp))
replace_na(data = DF1$MinTemp, replace = median(DF1$MinTemp))
replace_na(data = DF1$MinTemp, replace = median(DF1$MinTemp, na.rm = T))
replace_na(data = DF1$MinTemp, replace = median(DF1$MinTemp, na.rm = T)) %>% anyNA()
median(DF1$MinTemp, na.rm = T)
median(DF1$MinTemp, na.rm = F)
DF1$MinTemp
DF
for (i in 2:(length(DF)-1)) {
DF <- DF %>%
replace_na(data = DF[,i], replace = median(DF[,i], na.rm = T))
}
for (i in 2:(length(DF)-1)) {
DF <- DF %>%
mutate(replace_na(data = DF[,i], replace = median(DF[,i], na.rm = T)))
}
anyNA(DF)
colSums(is.na(DF))
DF <- weatherAU %>%
select(-(categorical)) %>%
select(-RISK_MM)
head(DF)
rm(DF1)
for (i in 2:(length(DF)-1)) {
DF[,i] <- replace_na(data = DF[,i], replace = median(DF[,i], na.rm = T))
}
colSums(is.na(DF))
DF %>% select(colnames(.)[2:17]) %>%
pivot_longer(cols = colnames(.)[1:16], names_to = "Type", values_to = "Value") %>%
mutate(Type = as.factor(Type)) %>%
ggplot(aes(x = Type,
y = Value)) +
coord_flip() +
geom_boxplot(aes(fill = Type), show.legend = F)
anyNA(DF)
plot(DF$Date, DF$RainTomorrow)
DF <- weatherAU %>%
select(-(categorical)) %>%
select(-c(Date, RISK_MM))
head(DF)
colSums(is.na(DF))
cat("\n")
colSums(is.na(DF))/nrow(DF)
for (i in 1:(length(DF)-1)) {
DF[,i] <- replace_na(data = DF[,i], replace = median(DF[,i], na.rm = T))
}
anyNA(DF)
table(DF$RainTomorrow)
prop.table(DF$RainTomorrow)
table(DF$RainTomorrow)
prop.table(table(DF$RainTomorrow))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
weatherAU <- read.csv("weatherAUS.csv")
weatherAU
str(weatherAU)
categorical <- vector()
for (i in 1:(length(weatherAU)-1)) {
if (class(weatherAU[,i]) == "factor") {
category <- colnames(weatherAU)[i]
categorical <- c(categorical, category)
}
}
weatherAU[,categorical] # to be removed
DF <- weatherAU %>%
select(-(categorical)) %>%
select(-c(Date, RISK_MM))
table(DF$RainTomorrow)
library(tidyverse) # for data wrangling
library(caret) # for confusion matrix
library(gtools) # for converting log of odds to probs
library(car) # for executing VIF test
library(rsample) # for splitting dataset into train and test with controlled proportion
library(class) # for KNN
weatherAU <- read.csv("weatherAUS.csv")
weatherAU
categorical <- vector()
weatherAU[,categorical] # to be removed
weatherAU[,categorical] # to be removed
categorical <- vector()
for (i in 1:(length(weatherAU)-1)) {
if (class(weatherAU[,i]) == "factor") {
category <- colnames(weatherAU)[i]
categorical <- c(categorical, category)
}
}
weatherAU[,categorical] # to be removed
DF <- weatherAU %>%
select(-(categorical)) %>%
select(-RISK_MM)
head(DF)
ncol(DF)
colSums(is.na(DF))
cat("\n")
colSums(is.na(DF))/nrow(DF)
for (i in 1:(length(DF)-1)) {
DF[,i] <- replace_na(data = DF[,i], replace = median(DF[,i], na.rm = T))
}
anyNA(DF)
table(DF$RainTomorrow)
prop.table(table(DF$RainTomorrow))
str(DF)
library(PerformanceAnalytics)
chart.Correlation(DF, hist = T)
library(PerformanceAnalytics)
chart.Correlation(DF[,1:16], hist = T)
library(psych)
pairs.panels(redDF)
library(psych)
pairs.panels(DF)
detach("package:PerformanceAnalytics", unload = TRUE)
library(GGally)
ggcorrplot(DF %>% cor(),
hc.order = TRUE, type = "lower",
lab = TRUE,
digits = 1,
ggtheme = ggplot2::theme_dark(),
)
ggcorrplot::ggcorrplot(DF %>% cor(),
hc.order = TRUE, type = "lower",
lab = TRUE,
digits = 1,
ggtheme = ggplot2::theme_dark(),
)
ggcorrplot::ggcorrplot(DF %>% select(-RainTomorrow) %>% cor(),
hc.order = TRUE, type = "lower",
lab = TRUE,
digits = 1,
ggtheme = ggplot2::theme_dark(),
)
GGally::ggcorr(DF %>% select(-RainTomorrow))
GGally::ggcorr(DF %>% select(-RainTomorrow), label = T)
ggcorrplot::ggcorrplot(DF %>% select(-RainTomorrow) %>% cor(),
hc.order = TRUE, type = "lower",
lab = TRUE,
digits = 1,
ggtheme = ggplot2::theme_dark(),
)
cor(DF$Pressure3pm, DF$Pressure9am)
library(psych)
pairs.panels(DF %>% select(-RainTomorrow))
GGally::ggpairs(DF %>% select(-RainTomorrow))
ggcorrplot::ggcorrplot(DF %>% select(-RainTomorrow) %>% cor(),
hc.order = TRUE, type = "lower",
lab = TRUE,
digits = 1,
ggtheme = ggplot2::theme_dark(),
)
cor.test(DF %>% select(-RainTomorrow))
cor.test(DF$MinTemp, DF$MaxTemp)
cor.test(DF$RainTomorrow, DF$MaxTemp)
vec <- setNames(sides, shapes)
shapes<- c("Square", "Triangle","Octagon","Hexagon")
sides<-c(4,3,8,6)
vec <- setNames(sides, shapes)
vec
combn(vec, 2)
combn(vec, 3)
combn(vec, 4)
combn(vec, 5)
combn(vec, 1)
combn(vec, 2)
combn
combn(colnames(DF), 2)
combn(colnames(DF[,1:16]), 2)
dim(combn(colnames(DF[,1:16]), 2))
dim(combn(colnames(DF), 2))
DFcomb <- combn(combn(colnames(DF[,1:16]), 2))
DFcomb <- combn(colnames(DF[,1:16]), 2)
DFcomb
length(Fcomb)
length(DFcomb)
dim(DFcomb)
dim(DFcomb)[2]
DFcomb
head(DF[,"MinTemp"])
DF[,"MinTemp"]
corTest <- cor.test(DF$MinTemp, DF$MaxTemp)
corTest$p.value
corTest
Alpha <- 0.05
for (i in 1:dim(DFcomb)[2]) {
print(paste0("Cor test between ", DFcomb[1,i], " and ", DFcomb[2,i]))
corTest <- cor.test(DF[,DFcomb[1,i]], DF[,DFcomb[2,i]])
ifelse(corTest$p.value < Alpha, "Multicollinear detected", "Safe! No Multicollinear")
cat("\n")
}
for (i in 1:dim(DFcomb)[2]) {
print(paste0("Cor test between ", DFcomb[1,i], " and ", DFcomb[2,i]))
corTest <- cor.test(DF[,DFcomb[1,i]], DF[,DFcomb[2,i]])
ifelse(corTest$p.value < Alpha, print("Multicollinear detected"), print("Safe! No Multicollinear"))
cat("\n")
}
